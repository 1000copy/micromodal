var version="0.2.1";const MicroModal=(()=>{const e=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'];class t{constructor({targetModal:targetModal,triggers:triggers=[],disableScroll:disableScroll=!1,debugMode:debugMode=!1,onShow:onShow=(()=>{}),onClose:onClose=(()=>{}),openTrigger:openTrigger="data-micromodal-trigger",closeTrigger:closeTrigger="data-micromodal-close"}={}){this.modal=document.getElementById(targetModal),triggers.length>0&&this.registerTriggers(...triggers),this.disableScroll=disableScroll,this.closeTrigger=closeTrigger,this.callbacks={onShow:onShow,onClose:onClose},this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}registerTriggers(...e){e.forEach(e=>{e.addEventListener("click",()=>this.showModal())})}showModal(){this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),window.requestAnimationFrame(()=>{this.modal.classList.add("is-open");this.setFocusToFirstNode()}),this.scrollBehaviour("disable"),this.addEventListeners(),this.callbacks.onShow(this.modal)}closeModal(){const e=this.modal;this.modal.addEventListener("animationend",function t(){window.requestAnimationFrame(()=>e.classList.remove("is-open")),e.removeEventListener("animationend",t,!1)},!1),this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement.focus(),this.callbacks.onClose(this.modal)}scrollBehaviour(e){if(!1!==this.disableScroll){const t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:"initial",height:"initial"});break;case"disable":Object.assign(t.style,{overflow:"hidden",height:"100vh"})}}}addEventListeners(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}removeEventListeners(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}onClick(e){e.target.hasAttribute(this.closeTrigger)&&(this.closeModal(),e.preventDefault())}onKeydown(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.maintainFocus(e)}getFocusableNodes(){const t=this.modal.querySelectorAll(e);return Object.keys(t).map(e=>t[e])}setFocusToFirstNode(){const e=this.getFocusableNodes();e.length&&e[0].focus()}maintainFocus(e){var t=this.getFocusableNodes(),o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),e.shiftKey||o!==t.length-1||(t[0].focus(),e.preventDefault())}}const o=(e,t)=>{const o=[];e.forEach(e=>{const n=t&&e.attributes[t].value||e.dataset.micromodalTrigger;void 0===o[n]&&(o[n]=[]);o[n].push(e)});return o};const n=e=>{if(!document.getElementById(e))return console.warn(`MicroModal v${version}: ❗Seems like you have missed %c'${e}'`,"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn(`%cExample:`,"background-color: #f8f9fa;color: #50596c;font-weight: bold;",`<div class="modal" id="${e}"></div>`),!1};const i=e=>{if(e.length<=0)return console.warn(`MicroModal v${version}: ❗Please specify at least one %c'micromodal-trigger'`,"background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn(`%cExample:`,"background-color: #f8f9fa;color: #50596c;font-weight: bold;",`<a href="#" data-micromodal-trigger="my-modal"></a>`),!1};const s=(e,t)=>{i(e);if(!t)return!0;for(var o in t)n(o);return!0};const r=e=>{const n=e||{};const i=[...document.querySelectorAll(!!n.openTrigger&&"["+n.openTrigger+"]"||"[data-micromodal-trigger]")];const r=o(i,n.openTrigger);if(!0===n.debugMode&&!1===s(i,r))return;for(var c in r){let e=r[c];n.targetModal=c,n.triggers=[...e],new t(n)}};let c=null;const l=(e,o)=>{const i=o||{};i.targetModal=e;if(!0===i.debugMode&&!1===n(e))return;c=new t(i);c.showModal()};const a=()=>{c.closeModal()};return{init:r,show:l,close:a}})();export default MicroModal;
